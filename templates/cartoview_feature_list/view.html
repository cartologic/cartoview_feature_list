{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ instance.title }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="viewport" content="width=device-width, height=device-height">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ol3/4.3.2/ol.css" />
    <link rel="shortcut icon" type="image/png" href="{{ STATIC_URL }}cartoview/img/icon.png" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/slick.min.css" />
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.6.0/slick-theme.min.css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <style>
        html,body {
            height: 100%;
            margin: 0px;
            overflow: hidden
        }
        #root{
            height: 100%
        }
        

    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.4.4/proj4.js"></script>
</head>
<body>
<div style="height: 100%;" id="root"></div>
<script src="{% static 'cartoview_feature_list/dist/FeatureList.bundle.js?version=2' %}"></script>
<script type="text/javascript">
    {% if instance %}
            var instanceId= {{ instance.id }}
            const urls={
                mapJsonUrl: "{% url 'map_json' mapid=instance.map.id %}",
                proxy: "{{ PROXY_URL }}",
                appInstance: "{% url 'api_dispatch_detail' api_name='api' resource_name='appinstances' pk=instance.id %}",
                geoserverUrl : "{{ GEOSERVER_BASE_URL }}",
                wfsURL : "{{ GEOSERVER_BASE_URL }}wfs",
                static: "{{ STATIC_URL }}",
                media: "{{ MEDIA_URL }}",
                rest: "{% url 'app_manager_base_url' %}rest/app_manager/",
                geonodeRest: "{% url 'api_api_top_level' 'api' %}",
                attachmentUploadUrl:function(layerName){
                    return '/apps/cartoview_attachment_manager/'+layerName+'/file'
            },
            viewURL: "{% url "cartoview_geo_collect.view" instance_id=instance.id %}",
            appLogo:'{% static 'cartoview_feature_list/logo.png' %}',
            }
    {% endif %}

    const props = {{ instance.config | safe }};
    
    props.formTitle="{{instance.title}}"
    props.formAbstract="{{instance.abstract}}"
    props.username="{{request.user.username}}"
    CartoviewFeatureList.show('root', props,urls);
  </script>
</body>
</html>
